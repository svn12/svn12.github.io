<!DOCTYPE html> <html lang="en"> 
    <head> <meta charset="UTF-8"> <title>General Query</title>
    <link rel="stylesheet" href="..\youtube\reset.css">
    <link rel="stylesheet" href="..\youtube\link_P_noside.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <style>
        form {
            margin: 0px;
            display: inline-block;
            font-size: 18px;
			/* background-color: yellow;  */
			width:95%;
        }
		
        input1,select{
            margin: 0px;
            display: inline;
            font-size: 18px;
        }

        /* label {display:inline;} */
        /* input {display:inline;} */
        button {
            font-size: 18px;
        }
		/*the container must be positioned relative:*/
		.autocomplete {
		  position: relative;
		  display: inline-block;
		}

		input {
		  border: 1px solid transparent;
		  background-color: #f1f1f1;
		  padding: 10px;
		  font-size: 16px;
		}

		input[type=text] {
		  background-color: #f1f1f1;
		  width: 350px;
		}

		input[type=submit] {
		  background-color: DodgerBlue;
		  color: #fff;
		  cursor: pointer;
		}

		.autocomplete-items {
		  position: absolute;
		  border: 1px solid #d4d4d4;
		  border-bottom: none;
		  border-top: none;
		  z-index: 99;
		  /*position the autocomplete items to be the same width as the container:*/
		  top: 100%;
		  left: 0;
		  right: 0;
		}

		.autocomplete-items div {
		  padding: 10px;
		  cursor: pointer;
		  background-color: #fff; 
		  border-bottom: 1px solid #d4d4d4; 
		}

		/*when hovering an item:*/
		.autocomplete-items div:hover {
		  background-color: #e9e9e9; 
		}

		/*when navigating through the items using the arrow keys:*/
		.autocomplete-active {
		  background-color: DodgerBlue !important; 
		  color: #ffffff; 
		}  
		strong {
			color :red;
			font-weight: bold;
		}
    </style>

    <link rel="stylesheet" href="..\youtube\link_P_noside.css"></head> 
<body> 
    

<script>
  $(document).ready(function(){
	testRD();
    $("form").submit(function(event){
            event.preventDefault();
            // alert("Submit prevented");
            Query_stk();
            
        
        });
    });

    function Query_stk(){
        // var findString = document.getElementById('location-input').value;
        let findString = $("#location-input").val();
		let pt=findString.indexOf(' ');
		if(pt>0){
			findString=findString.substr(0, pt)
		}
		//console.log(findString);
        // console.log(findString);
        if(findString.length>0){

// document.getElementById("yahoo").href ="https://tw.stock.yahoo.com/q/bc?s="+findString
$("#img1").attr("src","http://kgieworld.moneydj.com/rt/gif/gifstkchart2.djgif?w=600&h=450&id="+findString);
$("#img2").attr("src","http://kgieworld.moneydj.com/z/zc/zcw/zcwgif.djgif?b=8&cw=600&ch=450&a="+findString+".TW");
$("#img3").attr("src","http://stock.wearn.com/foreign_buy.asp?stockid="+findString);
$("#img4").attr("src","http://stock.wearn.com/acre.asp?stockid="+findString);
$("#img5").attr("src","http://stock.wearn.com/sale_chart.asp?stockid="+findString);
$("#img6").attr("src","http://stock.wearn.com/income_chart.asp?stockid="+findString);
$("#img7").attr("src","https://stock.wearn.com/foreign_chart.asp?stockid="+findString);
$("#img8").attr("src","https://stock.wearn.com/zhuli_chart.asp?stockid="+findString);



$("#link1").attr("href","http://www.goodinfo.tw/StockInfo/StockDetail.asp?STOCK_ID="+findString);
$("#link2").attr("href","https://statementdog.com/analysis/tpe/"+findString);
$("#link3").attr("href","https://histock.tw/stock/"+findString);
$("#link4").attr("href","http://www.cmoney.tw/finance/f00025.aspx?s="+findString);
$("#link5").attr("href","http://www.money-link.com.tw/stxba/index5.asp?id="+findString);
$("#link6").attr("href","http://stock.wearn.com/income.asp?mode=search&kind="+findString);
$("#link7").attr("href","http://www.capital.com.tw/rank/index3.asp?l=StkPrice.html&xy=0&a="+findString);
$("#link8").attr("href","http://pchome.megatime.com.tw/stock/sid"+findString+".html");


$("#yahoo").attr("href","https://tw.stock.yahoo.com/q/bc?s="+findString);
$("#fchart").attr("href","https://www.cnyes.com/twstock/flashchart/"+findString+".htm");

// document.getElementById("Ginfo").href ="https://goodinfo.tw/StockInfo/StockDetail.asp?STOCK_ID="+findString
// document.getElementById("Cmoney").href ="http://www.cmoney.tw/finance/f00025.aspx?s="+findString
// document.getElementById("Sdog").href ="https://statementdog.com/analysis/tpe/"+findString
$("#histock").attr("href","https://histock.tw/stock/" +findString );
$("#strea").attr("href","https://invest.wessiorfinance.com/stock_treasure_map.html?stock="+findString);

document.getElementById("stxba").href="http://www.money-link.com.tw/stxba/index5.asp?id=" +findString;
$("#wearn").attr("href","https://stock.wearn.com/a"+findString +".html");
// document.getElementById("wearn").href="https://stock.wearn.com/income.asp?mode=search&kind=" +findString  

document.getElementById("wantgoo").href="https://www.wantgoo.com/stock/" +findString 
document.getElementById("megatime").href="http://pchome.megatime.com.tw/stock/sid" +findString+".html"

document.getElementById("capital").href="http://www.capital.com.tw/rank/index3.asp?l=StkPrice.html&xy=0&a=" +findString

document.getElementById("tendy").href="http://stock.tendy.net/td2kline.php?sid=" +findString
document.getElementById("mops").href="http://mops.twse.com.tw/server-java/t164sb01?step=1&CO_ID="
    +findString +"&SYEAR=2021&SSEASON=4&REPORT_ID=C"
    

    }
    }
 function query_stock_no(){
        //  var qstr=encodeURI($("#location-input").val());
        var qstr=$("#location-input").val();
       
        
        url="https://www.wantgoo.com/investrue/all-alive"
        
        $("#demo1").html('');
        $.get(url,  function (data,status) {
            //console.log(data);
            var obj = JSON.parse(data);
            //console.log(obj);

            var txt='<br> <h1 align="center">TTT</h1>';
            
            txt += '<table  class="table"> <tbody>';
            
            
            for (x in obj.record){
                                
                //    url2=url2.replace("bklcl", "tghg");
                txt += "<tr>";
                txt += '<td valign="top"> <font size="-1">'+obj.record[x].chineses+''+                           obj.record[x].chap.toString()+":"+obj.record[x].sec.toString() + "</font> </td>";
                txt += "<td>" + obj.record[x]["bible_text"] + "</td>";
                txt += "</tr>";

            };
                    
                    txt += "</tbody></table>"
                    $("#demo1").html(txt);
                     
            
        })
        
        
    }  
//---------------
		function autocomplete_CH(inp, arr) {
		// -----------------------
		  /*the autocomplete function takes two arguments,
		  the text field element and an array of possible autocompleted values:*/
		  var currentFocus;
		  /*execute a function when someone writes in the text field:*/
		  inp.addEventListener("input", function(e) {
			  let start_pos,mmatch,a, b, i, val = this.value;
			  /*close any already open lists of autocompleted values*/
			  closeAllLists();
			  if (!val) { return false;}
			  currentFocus = -1;
			  /*create a DIV element that will contain the items (values):*/
			  a = document.createElement("DIV");
			  a.setAttribute("id", this.id + "autocomplete-list");
			  a.setAttribute("class", "autocomplete-items");
			  /*append the DIV element as a child of the autocomplete container:*/
			  this.parentNode.appendChild(a);
			  /*for each item in the array...*/
			  for (i = 0; i < arr.length; i++) {
				/*check if the item starts with the same letters as the text field value:
				if (arr[i].substr(0, val.length).toUpperCase() == val.toUpperCase()) {  
				mmatch=arr[i].toUpperCase().match(val.toUpperCase())*/
				mmatch=arr[i].match(val)
				if (mmatch ) {
				  start_pos=mmatch?.index;
				  /*create a DIV element for each matching element:*/
				  b = document.createElement("DIV");
				  /*make the matching letters bold:*/
				  if(start_pos==0){
					b.innerHTML = "<strong>" + arr[i].substr(start_pos, val.length) + "</strong>";
					b.innerHTML += arr[i].substr(val.length);
				  }else
				  {
					b.innerHTML = arr[i].substr(0,start_pos);
					b.innerHTML += "<strong>" + arr[i].substr(start_pos, val.length) + "</strong>";
					b.innerHTML += arr[i].substr(start_pos+val.length);
				  }
				  
				  /*insert a input field that will hold the current array item's value:*/
				  b.innerHTML += "<input type='hidden' value='" + arr[i] + "'>";
				 // b.innerHTML = arr[i]+"<input type='hidden' value='" + arr[i] + "'>";
				  /*execute a function when someone clicks on the item value (DIV element):*/
				  b.addEventListener("click", function(e) {
					  /*insert the value for the autocomplete text field:*/
					  inp.value = this.getElementsByTagName("input")[0].value;
					  //qTel();
					  Query_stk();
					  /*close the list of autocompleted values,
					  (or any other open lists of autocompleted values:*/
					  closeAllLists();
				  });
				  a.appendChild(b);
				}
			  }
		  });
		  /*execute a function presses a key on the keyboard:*/
		  inp.addEventListener("keydown", function(e) {
			  var x = document.getElementById(this.id + "autocomplete-list");
			  if (x) x = x.getElementsByTagName("div");
			  if (e.keyCode == 40) {
				/*If the arrow DOWN key is pressed,
				increase the currentFocus variable:*/
				currentFocus++;
				/*and and make the current item more visible:*/
				addActive(x);
			  } else if (e.keyCode == 38) { //up
				/*If the arrow UP key is pressed,
				decrease the currentFocus variable:*/
				currentFocus--;
				/*and and make the current item more visible:*/
				addActive(x);
			  } else if (e.keyCode == 13) {
				/*If the ENTER key is pressed, prevent the form from being submitted,*/
				e.preventDefault();
				if (currentFocus > -1) {
				  /*and simulate a click on the "active" item:*/
				  if (x) x[currentFocus].click();
				}
			  }
		  });
		  

		  function addActive(x) {
			/*a function to classify an item as "active":*/
			if (!x) return false;
			/*start by removing the "active" class on all items:*/
			removeActive(x);
			if (currentFocus >= x.length) currentFocus = 0;
			if (currentFocus < 0) currentFocus = (x.length - 1);
			/*add class "autocomplete-active":*/
			x[currentFocus].classList.add("autocomplete-active");
		  }
		  function removeActive(x) {
			/*a function to remove the "active" class from all autocomplete items:*/
			for (var i = 0; i < x.length; i++) {
			  x[i].classList.remove("autocomplete-active");
			}
		  }
		  function closeAllLists(elmnt) {
			/*close all autocomplete lists in the document,
			except the one passed as an argument:*/
			var x = document.getElementsByClassName("autocomplete-items");
			for (var i = 0; i < x.length; i++) {
			  if (elmnt != x[i] && elmnt != inp) {
				x[i].parentNode.removeChild(x[i]);
			  }
			}
		  }
		  /*execute a function when someone clicks in the document:*/
		  document.addEventListener("click", function (e) {
			  closeAllLists(e.target);
		  });
		}
		async function testRD(){
			$('input[type="text"]').val('');
			const fmain='https://docs.google.com/spreadsheets/d/1SoMEYJbCHBd3FDl8gjaiQMZ1WBCkDTazGHALGnKgMpk/edit?usp=sharing';
			// ScrapStock_link
			
			const a = {
				
				sheetUrl:fmain,
				sheetTag: '上市櫃2',
				key:2
				};
			const RSheet2Json_APIV2='https://script.google.com/macros/s/AKfycbz64VaqfqXVBwcFfDgDfehn947foLoeEOD6WXsvu3BNcXK6ZgTxjQAbzsIqSWmptLAo/exec'
			const RSheet2Json_APIV5='https://script.google.com/macros/s/AKfycbwFUIATzqJ3aaUP0TjLsA7WuHp9SG21RGdQ3AAFhw1lWSSSYGjQjdbC3rRfEn9Z3RPFrA/exec'


			tt= await getJSON(	RSheet2Json_APIV5,a).then(function(data) {
						console.log(data);
						return  data;
						})
			//console.log(tt);
			let arr=[];
				for(t in tt){
					arr.push(tt[t][1]);
				}
			arr.shift();
					
			autocomplete_CH(document.getElementById("location-input"), arr);
			//return tt;	
		};

		async function getJSON(urlptr,para) {
			try {
				  var url = new URL(urlptr);
				  for (let k in para) { url.searchParams.append(k, para[k]); }
				  
				 
				  const response = await fetch(url);
				  //let myText = await response.json();//JSON.parse(myObject);// myObject.text();JSON.parse(data)
				  return response.json();// myObject.text();JSON.parse(data)
				} catch (error) {
				   return(error);
				}
		  
			}
		
</script>
 <form id="location-form" class="form-inline">
         <label for="text"><a href="https://www.wantgoo.com/stock"> 大盤&nbsp &nbsp</a></label>
         
         <label for="text"><a href="https://www.wantgoo.com/stock/ranking/top-gainer"  target="_blank"> 排行&nbsp &nbsp</a></label>
         <label for="text"><a href="https://justdata.moneydj.com/z/zn/zna/zna.djhtm"  target="_blank"> 全球指數&nbsp &nbsp</a></label>
         <label for="text"><a href="https://justdata.moneydj.com/z/ze/zeg/zeg_23.djhtm"  target="_blank"> 行情表&nbsp &nbsp</a></label>
         <!-- <button onclick="query_stock_no()">查詢</button> -->
          <!-- <input type="text" class="form-control" placeholder="輸入股票代碼" id="location-input" onchange="Query_stk()"> -->
         <!-- <input type="text" id="location-input" > 
		 <input id="btnClickMe" type="button" value="  查詢" >
		 <input type="text" class="form-control" placeholder="輸入股票代碼" id="location-input" onchange="Query_stk()" >
		 -->
		 <div  class="autocomplete" >
			
			<input autocomplete="off" type="text"  class="form-control" placeholder="輸入股票代碼" id="location-input" />
		
		</div>
		 
         <button type="button" class="btn  btn-primary "  onclick="Query_stk()" > Go</button>

     </form>
<div id="demo1"></div>

<div class="main"> 
<li class="item1"><a href="https://tw.stock.yahoo.com/h/kimosel.php?form=menu&form_id=stock_id&form_name=stock_name"  target="_blank">個股代號</a></li>
<li class="item1"><a href="https://svn12.github.io/stock/JK_Stock.htm">關注</a></li>
<li class="item1"><a href="https://justdata.moneydj.com/z/zk/zk0/zkhome.djhtm">選股大師</a></li>
<li class="item1"><a href="https://finance.yahoo.com/portfolio/pf_1/view/v1">雅虎</a></li>
<li class="item1"><a id= "wantgoo" href="https://www.wantgoo.com/stock/2356" >玩股網</a></li>   
<li class="item1"> <a id="yahoo" href="https://tw.stock.yahoo.com/q/bc?s=2356">Yahoo</a> </li>
<li class="item1"> <a id="fchart" href="https://www.cnyes.com/twstock/flashchart/2356.htm">聚亨股市</a> </li>
<!-- <li class="item1"> <a id="Ginfo" href="https://goodinfo.tw/StockInfo/StockDetail.asp?STOCK_ID=2356">GoodInfo</a> </li>
<li class="item1"> <a id="Cmoney" href="http://www.cmoney.tw/finance/f00025.aspx?s=2356">Cmoney</a> </li>
<li class="item1"> <a id="Sdog" href="https://statementdog.com/analysis/tpe/2356">財報狗</a> </li> -->

<!-- <iframe id ="stxba" src="http://www.money-link.com.tw/stxba/index5.asp?id=2356" frameborder="0"allow="autoplay; encrypted-media" allowfullscreen></iframe> -->
<!-- <iframe id="wearn" src="https://stock.wearn.com/income.asp?mode=search&kind=2356" frameborder="0"allow="autoplay; encrypted-media" allowfullscreen></iframe> -->
<li class="item1"><a id="wearn" href="https://stock.wearn.com/a2356.html">聚財網</a></li>
<li class="item1"><a id ="stxba" href="http://www.money-link.com.tw/stxba/index5.asp?id=2356">精誠</a></li>


<!-- <iframe id= "wantgoo" src="https://www.wantgoo.com/stock/2356" frameborder="0"allow="autoplay; encrypted-media" allowfullscreen></iframe> -->
<!-- <iframe id="megatime" src="http://pchome.megatime.com.tw/stock/sid2356.html" frameborder="0"allow="autoplay; encrypted-media" allowfullscreen></iframe> -->

<!-- <iframe id= "capital" src="http://www.capital.com.tw/rank/index3.asp?l=StkPrice.html&xy=0&a=2356" frameborder="0"allow="autoplay; encrypted-media" allowfullscreen></iframe> -->
<!-- <iframe id="tendy" src="http://stock.tendy.net/td2kline.php?sid=2356" frameborder="0"allow="autoplay; encrypted-media" allowfullscreen></iframe> -->
<!-- <iframe id="histock" src="https://histock.tw/stock/2356" frameborder="0"allow="autoplay; encrypted-media" allowfullscreen></iframe>
<iframe id ="strea" src="https://invest.wessiorfinance.com/stock_treasure_map.html?stock=2356" frameborder="0"allow="autoplay; encrypted-media" allowfullscreen></iframe> -->
<li class="item1"  ><a id="histock" href="https://histock.tw/stock/2356">HiStock</a></li>
<li class="item1" ><a id="strea" href="https://invest.wessiorfinance.com/stock_treasure_map.html?stock=2356">樂活五線譜</a></li>

<li class="item1"><a id="megatime" href="http://pchome.megatime.com.tw/stock/sid2356.html">PCHome股</a></li>
<li class="item1"><a id= "capital" href="http://www.capital.com.tw/rank/index3.asp?l=StkPrice.html&xy=0&a=2356">群益網</a></li>
<li class="item1"><a id="tendy" href="http://stock.tendy.net/td2kline.php?sid=2356">天地日週K線</a></li>
<li class="item1"><a id="mops" href="http://mops.twse.com.tw/server-java/t164sb01?step=1&CO_ID=2356&SYEAR=2020&SSEASON=4&REPORT_ID=C">財務報表</a></li>

<!-- <iframe id="mops" src="http://mops.twse.com.tw/server-java/t164sb01?step=1&CO_ID=2356&SYEAR=2020&SSEASON=2&REPORT_ID=C" frameborder="0"allow="autoplay; encrypted-media" allowfullscreen></iframe> -->
</div>

<table border="1" cellspacing="0" cellpadding="7"> 
<tr>  
<td>  <a id="link1" href="http://www.goodinfo.tw/StockInfo/StockDetail.asp?STOCK_ID=2356" target="_blank">
<img id="img1" width='470' alt="台灣股市資訊網" title="台灣股市資訊網"  src="http://kgieworld.moneydj.com/rt/gif/gifstkchart2.djgif?w=600&h=450&id=2356"></a> </td>
<td> <a id="link2" href="https://statementdog.com/analysis/tpe/2356" target="_blank">
<img  id="img2" width='470'  alt="財報狗" title="財報狗" src="http://kgieworld.moneydj.com/z/zc/zcw/zcwgif.djgif?b=8&cw=600&ch=450&a=2356.TW"></a> </td>
</tr>

<tr>
 <td> <a id="link6" href="http://stock.wearn.com/income.asp?mode=search&kind=2356" target="_blank">
<img id="img6" width='470' alt="聚財網" title="聚財網" src="http://stock.wearn.com/income_chart.asp?stockid=2356"></a> </td>
 <td>  <a id="link4" href="http://www.cmoney.tw/finance/f00025.aspx?s=2356" target="_blank">
<img id="img4" width='470' alt="Cmoney 股市分析" title="Cmoney 股市分析" src="http://stock.wearn.com/acre.asp?stockid=2356"></a> </td> 
</tr> 


<tr> <td> <a id="link5" href="http://www.money-link.com.tw/stxba/index5.asp?id=2356" target="_blank">
<img id="img5" width='470' alt="精誠資訊" title="精誠資訊" src="http://stock.wearn.com/sale_chart.asp?stockid=2356"></a> </td>
 
<td> <a id="link3" href="https://histock.tw/stock/2356" target="_blank">
<img id="img3" width='470'  alt="Hi Stock" title="Hi Stock" src="http://stock.wearn.com/foreign_buy.asp?stockid=2356"></a> </td>
</tr> 

<tr> <td> <a id="link7" href="http://www.capital.com.tw/rank/index3.asp?l=StkPrice.html&xy=0&a=2356" target="_blank">
<img id="img7" width='470' alt="群益網" title="群益網" src="https://stock.wearn.com/foreign_chart.asp?stockid=2356"></a> </td>
 
<td> <a id="link8" href="http://pchome.megatime.com.tw/stock/sid2356.html" target="_blank">
<img id="img8" width='470'  alt="PChome" title="PCHome股" src="https://stock.wearn.com/zhuli_chart.asp?stockid=2356"></a> </td>
</tr> 
</table>
<!-- <iframe id="histock1" src="https://www.wantgoo.com/stock" frameborder="0"allow="autoplay; encrypted-media" allowfullscreen></iframe> -->


 </body> </html> 

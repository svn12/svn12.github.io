<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>MyStockQ.htm</title>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<script src="https://d3js.org/d3.v4.js"></script>
<script>

function appendText1(code) {
  $("#T2").append(code +' '); 
  var str_code="";
  str_code=code;
  var txt1 = '<table border="1" cellspacing="0" cellpadding="7"> ';  
  	  txt1+='<tr>';  
      txt1+=' <td>  <a id="link1" href="http://www.goodinfo.tw/StockInfo/StockDetail.asp?STOCK_ID='+code+'" target="_blank"> <img id="img1" width="470" alt="台灣股市資訊網" title="台灣股市資訊網"  src="http://kgieworld.moneydj.com/rt/gif/gifstkchart2.djgif?w=600&h=450&id='+code+'"></a> </td>';
      txt1+=' <td> <a id="link2" href="https://statementdog.com/analysis/tpe/'+code+'" target="_blank"> <img  id="img2" width="470"  alt="財報狗" title="財報狗" src="http://kgieworld.moneydj.com/z/zc/zcw/zcwgif.djgif?b=8&cw=600&ch=450&a='+code+'.TW"></a> </td>';
      txt1+='</tr>';
      txt1+='<tr>';  
      txt1+='<td>  <a id="link4" href="http://www.cmoney.tw/finance/f00025.aspx?s='+code+'" target="_blank"><img id="img4" width="470" alt="Cmoney 股市分析" title="Cmoney 股市分析" src="http://stock.wearn.com/acre.asp?stockid='+code+'"></a> </td>';
      txt1+=' <td> <a id="link3" href="https://histock.tw/stock/'+code+'" target="_blank"> <img id="img3" width="470"  alt="Hi Stock" title="Hi Stock" src="http://stock.wearn.com/foreign_buy.asp?stockid='+code+'"></a> </td>';
      txt1+='</tr>';
      
      txt1+='</tr>';
      txt1+='<tr>';  
      txt1+=' <td> <a id="link7" href="http://www.capital.com.tw/rank/index3.asp?l=StkPrice.html&xy=0&a='+code+'" target="_blank"><img id="img7" width="470" alt="群益網" title="群益網" src="https://stock.wearn.com/foreign_chart.asp?stockid='+code+'"></a> </td>';
      txt1+='<td> <a id="link8" href="http://pchome.megatime.com.tw/stock/sid'+code+'.html" target="_blank"> <img id="img8" width="470"  alt="PChome" title="PCHome股" src="https://stock.wearn.com/zhuli_chart.asp?stockid='+code+'"></a> </td>';
      txt1+='</tr>';
      txt1+='<tr>';  
      
      txt1+=' <td> <a id="link5" href="http://www.money-link.com.tw/stxba/index5.asp?id='+code+'" target="_blank"> <img id="img5" width="470" alt="精誠資訊" title="精誠資訊" src="http://stock.wearn.com/sale_chart.asp?stockid='+code+'"></a> </td>';
      txt1+=' <td> <a id="link6" href="http://stock.wearn.com/income.asp?mode=search&kind='+code+'" target="_blank"> <img id="img6" width="470" alt="聚財網" title="聚財網" src="http://stock.wearn.com/income_chart.asp?stockid='+code+'"></a> </td>';
      
      txt1+='</table>';
  
  // Create text with HTML
  var txt2 = $("<p></p>").text("Text.");  // Create text with jQuery
  var txt3 = document.createElement("p");
  txt3.innerHTML = "Text.";         // Create text with DOM
  $("#T").append(txt1);   // Append new elements
}
function appendText(){
$("#T").html('');
$("#T2").html('');
// appendText1('0050');
// appendText1('0050');
// appendText1('2412');
// appendText1('3376');
// appendText1('6269');
var codeA=["0050","9917","5434","2891","0056","9925","00881","8422","4938"
,"6269","2458","3045","2356","2412","1101","2023"]
codeA.map(appendText1);

}
function show_a(link){
  appendText1(link.code);
  var txt2 = $("<p></p>").text(link.code); 
  // $("#T2").append(link.code +' '); 

}
function  Array_R(){
  $("#T2").html('');
  $("#T").html('');
  d3.csv("https://svn12.github.io/doc/my_自選股.csv", function(data) {
    console.log(data);
    data.map(show_a);
  })
//   C:\Users\TAI\Documents\Html5\金魚都能懂網頁設計入門\svn12.github.io\doc\person_by_country.tsv
// data - 家戶所得.csv
}
function  Google_sht_R(){
  $("#T2").html('');
  $("#T").html('');
  var findString =''
  if(findString=='!'){ findString = '';}
  var select_sh=$('#select_sh').val();
  var a = {
                    sheetUrl:'"https://docs.google.com/spreadsheets/d/1jx9hL4CZuyET00_6LYbcz4d23WLv7iMsLbcPR3xqGbo/edit?usp=sharing"',
                    sheetTag: select_sh,
                    findSting: findString
                    };
   $.get('https://script.google.com/macros/s/AKfycbx-smoEvM6pV4tRuQJio9iPC3SQBtSZO4aSUvYtpjwKuZQD6_Ey/exec', a, function (data) {
                    if(data.length==2){
                         $("#T2").html( '查無資料 請重新輸入再查詢');
                    }
                    else  if (data.length==0){ 
                        $("#T2").html('sheet Name 須為 "List"');}
                    else {

                    // console.log(data.length);
                    // console.log(data);
                    data = JSON.parse(data);

                    data.map(show_a);
                  }
                });
  // d3.csv("https://svn12.github.io/doc/my_自選股.csv", function(data) {
  //   console.log(data);
  //   data.map(show_a);
  // })
//   C:\Users\TAI\Documents\Html5\金魚都能懂網頁設計入門\svn12.github.io\doc\person_by_country.tsv
// data - 家戶所得.csv
}

</script>
<body>
<!-- <p>This is a paragraph.</p> -->
<button onclick="appendText()">Fixed Table</button>
<button onclick="Array_R()">Read CSV</button>
<!-- <button onclick="Google_sht_R()">Read G-Sheet</button> -->
 <select id="select_sh" onchange="Google_sht_R()";>
            <option value="" selected="selected">請選擇Sheet</option>
            <option value="List">List</option>
            <option value="List1">List1</option>
            <option value="List2">List2</option>
            <option value="List3">List3</option>
            <option value="List4">List4</option>
            <option value="List5">List5</option>
            <option value="List6">List6</option>
            <option value="List7">List7</option>
            <option value="List8">List8</option>
            
</select>
<a href="https://docs.google.com/spreadsheets/d/1jx9hL4CZuyET00_6LYbcz4d23WLv7iMsLbcPR3xqGbo/edit?usp=sharing">Edit</a>
<p id="T2"> </p>
<p id="T"> </p>
</body>
</html>
